<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Вступ у CASTRO</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .wrap{max-width:760px;margin:40px auto;padding:0 16px}
    .card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:18px}
    label{display:block;margin:12px 0 6px;font-weight:800}
    input,textarea,select{width:100%;padding:12px 14px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.25);color:#fff}
    textarea{min-height:110px;resize:vertical}
    .btn{margin-top:14px;display:inline-flex;gap:10px;align-items:center;justify-content:center;
      padding:12px 16px;border-radius:14px;border:1px solid rgba(255,255,255,.12);
      background:rgba(224,24,45,.18);font-weight:900;cursor:pointer}
    .ok{display:none;margin-top:14px}
    .discord{display:inline-flex;margin-top:10px;padding:12px 16px;border-radius:14px;
      background:#e0182d;color:#fff;text-decoration:none;font-weight:900}
    .muted{opacity:.75}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Анкета на вступ у сім’ю CASTRO</h1>
      <p class="muted">Заповни чесно. Після відправки з’явиться кнопка приєднання до Discord.</p>

      <form id="joinForm">
        <label>1) Ім’я та вік (IRL)</label>
        <input name="irl" required>

        <label>2) Нікнейм у грі (IC)</label>
        <input name="nick" required>

        <label>3) ID персонажа</label>
        <input name="id" required>

        <label>4) Скільки часу граєш на сервері?</label>
        <select name="timeOnServer" required>
          <option value="">Обери…</option>
          <option>Менше місяця</option>
          <option>1-3 місяці</option>
          <option>3-6 місяців</option>
          <option>Понад 6 місяців</option>
        </select>

        <label>5) Скільки годин граєш на день?</label>
        <input name="hoursPerDay" required>

        <label>6) Досвід участі у сім’ях/організаціях</label>
        <textarea name="exp" required></textarea>

        <label>7) Чому хочеш приєднатися саме до CASTRO?</label>
        <textarea name="why" required></textarea>

        <label>8) Твої сильні сторони як гравця</label>
        <textarea name="skills" required></textarea>

        <label>9) Маєш мікрофон / користуєшся голосовим?</label>
        <select name="mic" required>
          <option value="">Обери…</option>
          <option>Так</option>
          <option>Ні</option>
        </select>

        <label>10) Посилання на Discord / або @нік</label>
        <input name="discord" required>

        <label>11) Готовий(-а) дотримуватись правил CASTRO?</label>
        <select name="rules" required>
          <option value="">Обери…</option>
          <option>Так, повністю</option>
          <option>Ні</option>
          <option>Інше</option>
        </select>

        <label>12) Готовий(-а) змінити прізвище на CASTRO?</label>
        <select name="rename" required>
          <option value="">Обери…</option>
          <option>Так</option>
          <option>Ні</option>
          <option>Інше</option>
        </select>

        <label>13) Додаткова інформація (необов’язково)</label>
        <textarea name="extra"></textarea>

        <button class="btn" type="submit">✅ Відправити заявку</button>

        <div id="status" class="muted" style="margin-top:10px;"></div>

        <div id="ok" class="ok">
          <h3>✅ Заявку відправлено!</h3>
          <p class="muted">Приєднуйся до Discord для зв’язку та розгляду заявки.</p>
          <a class="discord" href="https://discord.gg/ТВОЯ_СИЛКА" target="_blank">Приєднатися до Discord</a>
        </div>
      </form>
    </div>
  </div>

  <script>
    const WORKER_URL = "https://winter-cake-f101.d-f-12339.workers.dev/submit";
    const FORM_SECRET = "CASTRO_JOIN_2026_SECURE"; // те саме, що у Worker env

    const form = document.getElementById("joinForm");
    const statusEl = document.getElementById("status");
    const okEl = document.getElementById("ok");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusEl.textContent = "⏳ Відправляємо заявку…";

      const data = Object.fromEntries(new FormData(form).entries());

      try {
        const res = await fetch(WORKER_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-Auth": FORM_SECRET
          },
          body: JSON.stringify(data)
        });

        const json = await res.json().catch(()=>({ok:false}));

        if (!res.ok || !json.ok) throw new Error("Send failed");

        statusEl.textContent = "";
        form.querySelector("button[type=submit]").disabled = true;
        okEl.style.display = "block";
        form.reset();
      } catch (err) {
        statusEl.textContent = "❌ Помилка відправки. Спробуй ще раз або напиши керівництву.";
      }
    });
  </script>
</body>
</html>
