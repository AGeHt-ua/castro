/* =========================================================
   FAMILY CASTRO — AUTH / PROFILE UI (cleaned & optimized)
   - Removes duplicates
   - Fixes authtip stray brace
   - Profile modal: premium look + inner scroll + sticky actions
   ========================================================= */

:root{
  --castro-red: rgba(224,24,45,1);
  --castro-red2: rgba(179,18,34,1);
  --txt: rgba(243,243,246,.95);
}

/* =========================
   AUTH WIDGET (top-right)
   ========================= */

.auth{
  position: fixed;
  top: 16px;
  right: 16px;
  z-index: 9999;

  display: flex;
  align-items: center;
  gap: 10px;

  padding: 10px 12px;
  border-radius: 18px;

  background: rgba(10,10,14,.65);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow:
    0 18px 60px rgba(0,0,0,.45),
    0 0 0 1px rgba(255,255,255,.06) inset;

  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.auth__btn{
  position: relative;
  overflow: hidden;

  display:inline-flex;
  align-items:center;
  gap:10px;

  cursor:pointer;
  padding: 10px 12px;

  border-radius: 16px;
  border: 1px solid rgba(224,24,45,.38);

  background:
    radial-gradient(120px 60px at 30% 20%, rgba(224,24,45,.22), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));

  color: var(--txt);
  font-weight: 900;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;

  box-shadow:
    0 14px 45px rgba(0,0,0,.35),
    0 0 26px rgba(224,24,45,.12);

  letter-spacing: .2px;
  transform: translateZ(0);
  transition: transform .2s ease, background .2s ease, border-color .2s ease, box-shadow .2s ease;
}

/* Discord icon inside button (svg/img) */
.auth__btn img,
.auth__discord{
  width: 18px;
  height: 18px;
  flex: 0 0 18px;
  display:block;
  object-fit: contain;
  opacity: .95;
  filter: drop-shadow(0 0 10px rgba(224,24,45,.22));
}

/* Glow + lift */
.auth__btn:hover{
  transform: translateY(-2px);
  border-color: rgba(224,24,45,.58);
  box-shadow:
    0 18px 55px rgba(0,0,0,.42),
    0 0 34px rgba(224,24,45,.22);
}

/* Shine sweep */
.auth__btn::before{
  content:"";
  position:absolute;
  inset:-2px;
  background: linear-gradient(
    110deg,
    transparent 0%,
    rgba(255,255,255,.14) 35%,
    rgba(224,24,45,.14) 50%,
    transparent 70%
  );
  transform: translateX(-120%);
  transition: transform .6s ease;
  pointer-events:none;
}
.auth__btn:hover::before{ transform: translateX(120%); }

/* Subtle embers dots */
.auth__btn::after{
  content:"";
  position:absolute;
  inset:0;
  background-image:
    radial-gradient(circle at 20% 30%, rgba(224,24,45,.22) 0 1px, transparent 2px),
    radial-gradient(circle at 70% 40%, rgba(255,255,255,.18) 0 1px, transparent 2px),
    radial-gradient(circle at 40% 75%, rgba(224,24,45,.18) 0 1px, transparent 2px);
  opacity:.35;
  mix-blend-mode: screen;
  pointer-events:none;
}

.auth__btn:active{ transform: translateY(-1px) scale(.99); }

.auth__btn:focus-visible{
  outline: none;
  box-shadow:
    0 18px 55px rgba(0,0,0,.42),
    0 0 0 3px rgba(224,24,45,.22),
    0 0 0 1px rgba(224,24,45,.55) inset;
}

.auth__user{
  display:flex;
  align-items:center;
  gap:10px;

  padding: 6px 10px;
  border-radius: 14px;

  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.05);
  color: var(--txt);
  font-weight: 900;

  max-width: 260px;

  cursor: pointer;
  transition: transform .2s ease, background .2s ease;
}
.auth__user:hover{ transform: translateY(-1px); background: rgba(255,255,255,.07); }
.auth__user:active{ transform: scale(0.97); }

.auth__avatar{
  width: 28px;
  height: 28px;
  border-radius: 50%;
  object-fit: cover;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
}

.auth__name{
  overflow:hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.auth__logout{
  cursor:pointer;
  margin-left: 6px;
  border: 0;
  background: transparent;
  color: rgba(243,243,246,.85);
  font-size: 18px;
  line-height: 1;
  padding: 4px 6px;
  border-radius: 10px;
  transition: background .2s ease;
}
.auth__logout:hover{ background: rgba(255,255,255,.08); }

.hidden{ display:none !important; }

@media (max-width: 520px){
  .auth{ top: 10px; right: 10px; padding: 8px 10px; }
  .auth__btn{ padding: 8px 10px; font-size: .92rem; }
  .auth__user{ max-width: 200px; }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .auth__btn,
  .auth__btn::before{
    transition: none !important;
  }
}

/* Generic locked button state (used by auth gate) */
button.locked{
  opacity: .5;
  cursor: not-allowed;
}

/* =========================
   AUTH NUDGE (spotlight onboarding)
   ========================= */
.nudge{
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: none;
}
.nudge.is-open{ display:block; }

.nudge__backdrop{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.65);
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

/* "прожектор" на auth кнопку (координати підставляє JS через CSS variables) */
.nudge.is-open .nudge__backdrop{
  --x: 50px;
  --y: 50px;
  --r: 90px;

  background:
    radial-gradient(circle var(--r) at var(--x) var(--y),
      rgba(0,0,0,0) 0%,
      rgba(0,0,0,0) 55%,
      rgba(0,0,0,.78) 75%,
      rgba(0,0,0,.92) 100%
    ),
    rgba(0,0,0,.62);
}

/* =========================
   AUTH TIP (bubble only; no arrows)
   ========================= */
.authtip{
  position: fixed;
  z-index: 9998;
  display: none;
  pointer-events: none; /* tip itself doesn't block */
}
.authtip.is-open{ display:block; }

.authtip__bubble{
  pointer-events: auto;
  width: min(320px, calc(100vw - 24px));
  padding: 14px 14px 12px;
  border-radius: 16px;

  background:
    radial-gradient(180px 120px at 30% 20%, rgba(224,24,45,.22), transparent 60%),
    rgba(12,12,16,.78);

  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 20px 70px rgba(0,0,0,.55);

  transform: translateX(16px);
  opacity: 0;
  transition: transform .45s ease, opacity .45s ease;
}
.authtip.is-open .authtip__bubble{
  transform: translateX(0);
  opacity: 1;
}

.authtip__title{
  font-weight: 900;
  font-size: .98rem;
  margin-bottom: 6px;
}
.authtip__text{
  color: rgba(243,243,246,.86);
  line-height: 1.3;
  font-size: .92rem;
}
.authtip__mono{
  display:block;
  margin-top: 8px;
  padding: 6px 10px;
  border-radius: 12px;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  font-weight: 900;
}
.authtip__actions{
  display:flex;
  gap: 10px;
  margin-top: 12px;
  justify-content:flex-end;
}
.authtip__btn{
  pointer-events: auto;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: #f3f3f6;
  font-weight: 900;
  border-radius: 14px;
  padding: 9px 12px;
  cursor:pointer;
  transition: transform .2s ease, background .2s ease;
}
.authtip__btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.09); }

.authtip__btn--primary{
  border-color: rgba(224,24,45,.45);
  background:
    radial-gradient(120px 60px at 30% 20%, rgba(224,24,45,.25), transparent 60%),
    rgba(224,24,45,.16);
  box-shadow: 0 0 22px rgba(224,24,45,.18);
}

/* Optional: subtle pulse on auth button while tip is open */
.authtip.is-open .auth__btn{
  animation: authHintPulse 1.2s ease-in-out infinite;
}
@keyframes authHintPulse{
  0%,100%{ box-shadow: 0 14px 45px rgba(0,0,0,.35), 0 0 26px rgba(224,24,45,.12); }
  50%{ box-shadow: 0 18px 55px rgba(0,0,0,.45), 0 0 46px rgba(224,24,45,.25); }
}

@media (prefers-reduced-motion: reduce){
  .authtip__bubble{ transition: none !important; }
  .authtip.is-open .authtip__bubble{ opacity: 1 !important; transform: none !important; }
  .authtip.is-open .auth__btn{ animation: none !important; }
}

/* =========================
   PROFILE MODAL
   ========================= */

.pmodal{
  position:fixed;
  inset:0;
  z-index: 9999;
  display:flex;
  align-items:center;
  justify-content:center;
}
.pmodal.hidden{ display:none; }

.pmodal__backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.55);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

/* Card layout: header + scrollable body + sticky actions */
.pmodal__card{
  position:relative;
  width: min(560px, calc(100% - 28px));
  max-height: calc(100vh - 28px);

  display:flex;
  flex-direction: column;
  overflow:hidden;

  border-radius: 22px;
  background:
    radial-gradient(900px 420px at 50% -220px, rgba(224,24,45,.18), transparent 65%),
    rgba(16,16,22,.92);
  border:1px solid rgba(255,255,255,.12);

  box-shadow:
    0 40px 140px rgba(0,0,0,.72),
    0 0 0 1px rgba(255,255,255,.06) inset;

  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.pmodal__head{
  flex: 0 0 auto;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;

  padding: 16px 18px;
  background: rgba(0,0,0,.18);
  border-bottom:1px solid rgba(255,255,255,.10);
}

.pmodal__head h2{ margin:0; font-size:1.05rem; }
.pmodal__title{ font-weight:1000; letter-spacing:.2px; }

.pmodal__x{
  width: 38px;
  height: 38px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.90);
  cursor:pointer;
}
.pmodal__x:hover{ background: rgba(255,255,255,.10); }

.pmodal__body{
  flex: 1 1 auto;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;

  padding: 14px 16px 18px;
  display:grid;
  gap: 12px;
}

.pmodal__label{
  font-weight: 1000;
  font-size:.9rem;
  color: rgba(245,245,250,.88);
}

.pmodal__input{
  width:100%;
  padding: 10px 12px;
  border-radius: 14px;

  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.28);
  color:#fff;

  outline:none;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
  transition: border-color .16s ease, box-shadow .16s ease;
}
.pmodal__input:hover{ border-color: rgba(255,255,255,.18); }
.pmodal__input:focus{
  border-color: rgba(224,24,45,.60);
  box-shadow: 0 0 0 4px rgba(224,24,45,.14);
}

/* Readonly/disabled — without ugly grey */
.pmodal__input[readonly],
.pmodal__input:disabled{
  opacity: 1;
  color: rgba(245,245,250,.78);
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.10);
}

.pmodal__hint{
  margin:0;
  color:rgba(255,255,255,.65);
  font-size:.85rem;
}

/* details (Історія / JSON) — scoped to modal */
.pmodal details{
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  padding: 10px 12px;
}
.pmodal details + details{ margin-top: 10px; }

.pmodal details summary{
  cursor:pointer;
  user-select:none;
  list-style: none;

  font-weight: 1000;
  font-size: .98rem;
  opacity: .92;
}
.pmodal details summary::-webkit-details-marker{ display:none; }
.pmodal details summary::after{
  content:"▾";
  float:right;
  opacity:.75;
  transform: translateY(1px);
}
.pmodal details[open] summary::after{ content:"▴"; }

/* Orders cards */
.porders{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin: 10px 0 4px;
}
.porder{
  border:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.22);
  border-radius: 14px;
  padding: 10px 12px;
}
.porder__top{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
}
.porder__id{
  font-weight:900;
  font-size: .95rem;
}
.porder__meta{
  margin-top:6px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px 10px;
  font-size:.9rem;
  opacity:.92;
}
.porder__meta b{ opacity: .9; }

.pbadge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.08);
  font-weight: 900;
  font-size: .85rem;
  white-space: nowrap;
}
.pbadge.ok{ border-color: rgba(46,204,113,.35); background: rgba(46,204,113,.12); }
.pbadge.wait{ border-color: rgba(241,196,15,.35); background: rgba(241,196,15,.12); }
.pbadge.no{ border-color: rgba(224,24,45,.35); background: rgba(224,24,45,.12); }

.porders__json textarea{
  margin-top: 8px;
  min-height: 110px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}

/* Sticky actions (always visible) */
.pmodal__actions{
  flex: 0 0 auto;
  position: sticky;
  bottom: 0;
  z-index: 5;

  display:flex;
  gap:10px;
  justify-content:flex-end;

  padding: 12px 16px;
  border-top:1px solid rgba(255,255,255,.10);

  background:
    linear-gradient(180deg, rgba(16,16,22,0), rgba(16,16,22,.92) 35%, rgba(16,16,22,.96));
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.pmodal__btn,
.pmodal__save,
.pmodal__cancel{
  padding: 11px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  color:#fff;
  font-weight: 1000;
  cursor: pointer;
  background: rgba(255,255,255,.06);
  transition: transform .18s ease, background .18s ease, border-color .18s ease, opacity .18s ease;
}
.pmodal__save{
  background: linear-gradient(135deg, rgba(224,24,45,.95), rgba(179,18,34,.95));
  border-color: rgba(224,24,45,.35);
  box-shadow: 0 18px 60px rgba(224,24,45,.18);
}
.pmodal__btn--ghost,
.pmodal__cancel{
  background: rgba(255,255,255,.06);
}
.pmodal__btn:hover,
.pmodal__save:hover,
.pmodal__cancel:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,.09);
}
.pmodal__save:hover{
  border-color: rgba(224,24,45,.55);
  background: linear-gradient(135deg, rgba(224,24,45,.98), rgba(179,18,34,.98));
}
.pmodal__btn:active,
.pmodal__save:active,
.pmodal__cancel:active{ transform: translateY(0); }

.is-locked{
  opacity: .85;
  cursor: not-allowed;
}
.is-locked:focus{ outline: none; }

/* Discord modal avatar */
.discord-modal img{
  width: 88px;
  height: 88px;
  border-radius: 24%;
}

/* =========================
   FIX: remove double scrollbars
   ========================= */

/* Забороняємо скрол фону, коли відкрита модалка */
body.modal-open{
  overflow: hidden;
}

/* Сам контейнер модалки — без скролу */
.pmodal{
  overflow: hidden;
}

/* Картка — без горизонтального скролу */
.pmodal__card{
  overflow: hidden;
}

/* Скрол ТІЛЬКИ тут */
.pmodal__body{
  overflow-y: auto;
  overflow-x: hidden;
}
